<html>
<head>
<script type="text/javascript" src="main.js" ></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" type="text/javascript"></script>
<script language="javascript" src="lib/sha1.js"></script> 
<script language="javascript" type="text/javascript">
utterances=new Array(5);
utterances[0]=new Array(5);
utterances[1]=new Array(5);
utterances[2]=new Array(5);
utterances[3]=new Array(5);
utterances[4]=new Array(5);
utterances[5]=new Array(5);
//the utterances array contain the actual text that can be placed on the message window

links=new Array(5);
links[0]=new Array(5);
links[1]=new Array(5);
links[2]=new Array(5);
links[3]=new Array(5);
links[4]=new Array(5);
links[5]=new Array(5);
//the links array contains keywords that perform different functions,  the most obvious one is that if the links array contains the name of another page, then it will cause a jump to that page when activated.  Other options include things like 'clear' and 'delete word' 

//Note that if the utterance and links are are *both* set, then the utterance will activate and *then* the link will activate.

function voiceinit(){
	var i,j;
	reset();
	var voice = new ActiveXObject("SAPI.SpVoice");
}


function speak(){
	var voice = new ActiveXObject("SAPI.SpVoice");
	voice.Speak(document.myform.outputtext.value);
}

//this function simply puts the message window in a URL and opens it in a separate page,  in this case to tweet
function tweet(){
	var twtTitle=document.myform.outputtext.value;
	var maxLength =140;
	if(twtTitle.length > maxLength)
	{
		twtTitle = twtTitle.substr(0, (maxLength -3))+'...';
	}
	var twtLink ='http://twitter.com/intent/tweet?text='+document.myform.outputtext.value.replace(" ","%20");
	window.open(twtLink);

}

//this function simply puts the message window in a URL and opens it in a separate page,  in this case to search Google Images
function image(){
	var temp =document.myform.outputtext.value;
	temp.replace(' ','+');
	myRef = window.open('http://www.google.co.uk/images?q=' + 
			temp,'search');
}


//this function simply puts the message window in a URL and opens it in a separate page,  in this case to search YouTube
function tube(){
	var temp =document.myform.outputtext.value;
	temp.replace(' ','+');
	myRef = window.open('http://www.youtube.com/results?search_query=' + 
			temp +'&search_type=&aq=0','search');

}

function reset(){
	var i,j
		for(j=0;j<5;j++)
		{
			for(i=0;i<5;i++)
			{
				utterances[i][j]="link";
				links[i][j]="blank";
			}
		}
links[3][0]="speak";

}

//The main function. First checks for an utterance to add, and then checks if a link should be activated. Within the utterance code we check the length of an addition - if it is a single character we assume that the user is spelling something and we do not insert the extra space. 
function add(i,j) {
	if(utterances[i][j]!="link")
	{ 
		if(utterances[i][j].length==1){//so that we can spell with the single letter buttons
			document.myform.outputtext.value += utterances[i][j];
		}else{
			document.myform.outputtext.value += " "+ utterances[i][j];
		}
	}
	if(links[i][j]!="blank")
	{
		switch(links[i][j])
		{
			//There are two special cases for links - clearing the message window, deleting the last word from the message window. Further special behaviours (volume change and the like) could be added here. 
			case "clear":  document.myform.reset();break;
			case "deleteword": var lastIndex =  document.myform.outputtext.value.lastIndexOf(" ");  document.myform.outputtext.value = document.myform.outputtext.value.substring(0, lastIndex);break;
			case "Backspace": document.myform.outputtext.value = document.myform.outputtext.value.substring(0, document.myform.outputtext.value.length-1);break;
			case "speak": makeWav(); break;
			case "google": image(); break;
			case "youtube": tube(); break;
			case "twitter": tweet();break;
			case "1": page1(); break;
			default: eval(links[i][j]+"()");
		}
	}
}

//calls the perl script that creates the *.wav file from the text given. This part requires an internet connection unless you can retarget to a local system (on a mac, for example, one can make a call to the command line utility 'say').
function makeWav(){        
	$.get(("getsound.pl?text="+document.myform.outputtext.value+"&filename="+SHA1(document.myform.outputtext.value)));
	setTimeout(callback, 500);
	_gaq.push(["_trackEvent", "azulejoe", "speak", "makeWav", 5, true]);
	return false;
}
//used within the above function - callback plays the wave that was created in makeWav() but only when it has finnished loading. 
function callback() {
utter=document.myform.outputtext.value;
	//the cb peramater is to force a reload, see http://stackoverflow.com/a/25823431/170243
	var url =  SHA1(document.myform.outputtext.value)+".wav?cb=" + new Date().getTime();
	var audio = new Audio(url);
	audio.load();
	audio.play();
}
</script>
<!--The next two lines are part of the code that adds the loading screen.  The other part is the div tag marked 'loader' -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript">
$(window).load(function() {
		$(".loader").fadeOut("slow");
		})
</script>
</head>


<body onload="page1()">
<div class="loader" style=" position: fixed; left: 0px; top: 0px; width: 100%; height: 100%; z-index: 9999; background: url('interface/page-loader.gif') 50% 50% no-repeat rgb(249,249,249); " ></div><!--Used to put in the loading graphic--> 
<!--START THE FOUR CONTROLS AT THE TOP OF THE PAGE--> 
<table border=0px><tr><td><form name="myform"> <textarea name="outputtext" style="font-size: 18pt; height:98px; width:415px ;box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; position:absolute; left:160px; top:126px;"></textarea>
</form></td><td>
<img onclick="makeWav()" src="interface/speak.png" height=100>
<img onclick="image()" src="interface/google.jpg" height=100>
<img onclick="tube()" src="interface/youtube.jpg" height=100>
<img onclick="tweet()" src="interface/twitter.png" height=100>
</td></tr></table>
<!--END THE FOUR CONTROLS AT THE TOP OF THE PAGE--> 

<!--START THE MAIN MAP --> 
<img name ="main" src="images/1.jpg" height=540 width=720 usemap="#voicemap" />
<map name ="voicemap">
<area shape="rect" coords="000,000,144,108" onClick="add(0,0)"  alt="Way!">
<area shape="rect" coords="144,000,288,108" onClick="add(1,0)"  alt="Way!">
<area shape="rect" coords="288,000,432,108" onClick="add(2,0)"  alt="Way!">
<area shape="rect" coords="432,000,576,108" onClick="add(3,0)"  alt="Way!">
<area shape="rect" coords="576,000,720,108" onClick="add(4,0)"  alt="Way!">

<area shape="rect" coords="000,108,144,216" onClick="add(0,1)"  alt="Way!">
<area shape="rect" coords="144,108,288,216" onClick="add(1,1)"  alt="Way!">
<area shape="rect" coords="288,108,432,216" onClick="add(2,1)"  alt="Way!">
<area shape="rect" coords="432,108,576,216" onClick="add(3,1)"  alt="Way!">
<area shape="rect" coords="576,108,720,216" onClick="add(4,1)"  alt="Way!">

<area shape="rect" coords="000,216,144,324" onClick="add(0,2)"  alt="Way!">
<area shape="rect" coords="144,216,288,324" onClick="add(1,2)"  alt="Way!">
<area shape="rect" coords="288,216,432,324" onClick="add(2,2)"  alt="Way!">
<area shape="rect" coords="432,216,576,324" onClick="add(3,2)"  alt="Way!">
<area shape="rect" coords="576,216,720,324" onClick="add(4,2)"  alt="Way!">

<area shape="rect" coords="000,324,144,432" onClick="add(0,3)"  alt="Way!">
<area shape="rect" coords="144,324,288,432" onClick="add(1,3)"  alt="Way!">
<area shape="rect" coords="288,324,432,432" onClick="add(2,3)"  alt="Way!">
<area shape="rect" coords="432,324,576,432" onClick="add(3,3)"  alt="Way!">
<area shape="rect" coords="576,324,720,432" onClick="add(4,3)"  alt="Way!">

<area shape="rect" coords="000,432,144,540" onClick="add(0,4)"  alt="Way!">
<area shape="rect" coords="144,432,288,540" onClick="add(1,4)"  alt="Way!">
<area shape="rect" coords="288,432,432,540" onClick="add(2,4)"  alt="Way!">
<area shape="rect" coords="432,432,576,540" onClick="add(3,4)"  alt="Way!">
<area shape="rect" coords="576,432,720,540" onClick="add(4,4)"  alt="Way!">
</map>

<!--END THE MAIN MAP-->

<!--START THE PRELOADING OF THE IMAGES-->
<div class="hidden">
	<script type="text/javascript">
var images = new Array()
	function preload() {
		for (i = 0; i < preload.arguments.length; i++) {
			images[i] = new Image()
				images[i].src = preload.arguments[i]
		}
	}
preload(
		"./images/aboutme.jpg", "./images/action.jpg", "./images/animals.jpg", "./images/artthings.jpg", "./images/birds.jpg", "./images/breakfast.jpg", "./images/chatting.jpg", "./images/christmas.jpg", "./images/clothes.jpg", "./images/colour.jpg", "./images/computer.jpg", "./images/cookingwords.jpg", "./images/days.jpg", "./images/describe.jpg", "./images/drinks.jpg", "./images/dvd.jpg", "./images/educationstaff.jpg", "./images/family.jpg", "./images/farmanimals.jpg", "./images/fastfood.jpg", "./images/feelings.jpg", "./images/fizzydrinks.jpg", "./images/food.jpg", "./images/foodchat.jpg", "./images/friends.jpg", "./images/fruit.jpg", "./images/furniture.jpg", "./images/gardening.jpg", "./images/insects.jpg", "./images/job.jpg", "./images/kitchenequipment.jpg", "./images/leisure.jpg", "./images/littlewords.jpg", "./images/lunch.jpg", "./images/materials.jpg", "./images/meals.jpg", "./images/meat.jpg", "./images/milkshake.jpg", "./images/money.jpg", "./images/months.jpg", "./images/moreaction.jpg", "./images/mp3.jpg", "./images/myday.jpg", "./images/mystories.jpg", "./images/numbers.jpg", "./images/office.jpg", "./images/opposites.jpg", "./images/outside.jpg", "./images/page1 copy.jpg", "./images/page1.jpg", "./images/parts.jpg", "./images/people.jpg", "./images/petcare.jpg", "./images/pets.jpg", "./images/pint.jpg", "./images/places.jpg", "./images/positionwords.jpg", "./images/potato.jpg", "./images/privateparts.jpg", "./images/questions.jpg", "./images/salad.jpg", "./images/sauces.jpg", "./images/scwfriends.jpg", "./images/shapes.jpg", "./images/shops.jpg", "./images/smoothy.jpg", "./images/snack.jpg", "./images/specialdays.jpg", "./images/spelling.jpg", "./images/sports.jpg", "./images/supportstaff.jpg", "./images/things.jpg", "./images/thingsthathelp.jpg", "./images/time.jpg", "./images/toiletries.jpg", "./images/tools.jpg", "./images/toys.jpg", "./images/transport.jpg", "./images/tv.jpg", "./images/vegetables.jpg", "./images/want.jpg", "./images/wateranimals.jpg", "./images/weather.jpg", "./images/home.jpg", "./images/wildanimals.jpg", "./images/nature.jpg", "./images/phone.jpg", "./images/yetmoreaction.jpg", "./images/wml.jpg")
</script>
</div>

<!--END THE PRELOADING OF THE IMAGES-->


<!--START THE GOOGLE ANALYTICS -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-43886525-1', 'auto');
ga('send', 'pageview');

</script>
</body>
</html>
